Примечание к релизу
Прошивка устройства ULC02

Данные примечания описывают этапы изменения по версиям прошивки ULC02

----------------------------------------------------------------------
Дата:	2022/07/08
Версия:	1.7.10

*   Добавлено отслеживание обрыва провода трехфазной сети по напряжению для счетчика Energomera CE318BY;
*   Адаптирована работа сквозного канала под особенности аппаратной части электросчетчика Energomera CE318BY;
*   Добавлены команды ручной инициализации/деинициализации UART (UARTSTART/UARTSTOP).

----------------------------------------------------------------------
Дата:   2022/04/04
Версия: 1.7.9

*   Исправлен переход по учету траффика на новый месяц;
*   Изменен алгоритм записи и чтения логов на цикличный подход работы с файлом, вместимость - 1000 записей (8000 байт);
*   Добавлена задержка в 1 минуту перед перезагрузкой после обновления прошивки;
*   Убрана горячая перезагрузка UART/ Применение настроек для RS485 только при старте;
*   Введение ожидания полной загрузки для работы по TCP;
*   Улучшена работа с изменениями в конфигурации;
*   Оптимизирована работа записи логов в файл;
*   Оптимизирована работа учета трафика;
*   Доработан механизм загрузки прошивки на устройство;
*   Перенесен запуск задачи расписания освещения до регистрации;
*   Добавлен функционал повторной регистрации в сети, в случае потери 
    соединения;
*   Увеличена стабильность загрузки и выхода в рабочий режим с переходом 
    от обработки таймеров на цикличные таски;
*   Исправлено ожидание на подключение сокета обновления прошивки;
*   Исправлена ситуация, когда UART переинициализировался даже когда 
    его параметры не менялись;
*   Добавлена обработка команд на управление димированием;
*   Добавлен ответ подтверждения с устройства о завершении загрузки 
    файла прошивки;
*   Добавлена реализация сторожевого таймера через функционал отложенной
    перезагрузки контроллера;
*   Доработана обработка ситуаций перезагрузки в согласовании планировщика 
    освещения (Если необходимость перезагрузки возникла во время активности
    планировщика в режиме включено, то перезагрузка переносится на момент 
    отключения освещения по сработке планировщика);
*   Изменен уровень логов для некоторых событий;
*   Добавлено извещение пользователя о некорректной команде при работе 
    через терминал;
*   Подкорректирована обработка команд при получении новой команды во время 
    обработки текущей команды;
*   Подкорректированы чтение и запись конфигурации через USB до регистрации 
    в сети;
*   Добавлены дополнительные проверки на валидность создания тасков;
*   Переведены все обработчики на аппаратные таймера (RS485 и таймера 
    протокола мэк104);
*   Исправлена реакция при управлении освещением (если повторно отправляется 
    команда на включение то ответ событием);
*   Добавлена команда запроса укороченного статуса `GETSTAT`;
*   Добавлена задержка на срабатывание отсроченной перезагрузке после 
    выключения выхода по расписанию;
*   При старте работы таски по работе с TCP дожидаются окончательной загрузки 
    устройства и уже после дают доступ подключаться клиентам;
*   Исправлено отключение пингования при получении в любом из октетов 
    IP-адреса значения 255; (примечание: к примеру 172.12.28.255 - так же 
    отключал пингование);
*   Исправлена ситуация что по команде чтения логов (`GETLOG` и `GETLOGF`) 
    при отсутствии логов ничего не возвращалось;
*   Пересмотрен алгоритм обработки команд. Реализована обработка "тяжелых" 
    команд с сохранением в файл в отдельный поток для исключения наполнения 
    буффера команд;
*   Добавлен учет и хранение траффика за текущий и предыдущий месяцы. Вывод 
    по команде `TRAF0` для трафика за текущий месяц и `TRAF1` - за предыдущий 
    месяц:
    TR:D(value)[keepAlive],T(value)[keepAlive],I(value)[keepAlive],U(value)
    D - порт отладки и конфигурации
    T - порт сквозной перезачи данных
    I - порт мэк104
    U - порт обновления прошивки
    () - трафик пакетов передачи данных
    [] - трафик по обработки KeepAlive
    пример вывода - TR:D3054[128],T(64852)[256],I(10240)[512],U(320152).

----------------------------------------------------------------------
Дата:   2021/09/27
Версия: 1.7.8

*   Добавлен вывод IMEI в панели состояния ZtpConfig;
*   Исправлено отображение ответа на переключение уровня логирования по 
    команде `LOGSLVL:[val]`;
*   Добавлена панель управления уровнем событий логирования 
    (отображается в ztpConfig версии 1.1.11.0 и выше).

----------------------------------------------------------------------
Дата:   2021/09/20
Версия: 1.7.7

*   Добавлено логирование событий;
*   Добавлена вычитка байтового массива кодированных логов по командам 
    `GETLOG` для вычитки файла с последними логами и `GETLOGF` для полной 
    вычитки всех логов;
*   Исправлена обработка событий по измению PDP контекста;
*   Реализована система контроля заполнения файлов логирования. Максимально 
    возможно на текущий момент 4 файла по 4096 байт логирования 
    (2000+ записей лога);
*   Добавлена команда очистки логов `DROPLOGS` для обратной совместимости 
    со старыми версиями прошивки в случае отката, вызовите через консоль 
    данную команду перед удаленной перепрошивкой, либо используйте ztpConfig 
    версии `1.1.9.0` или новее;
*   Изменена последовательность регистрации контроллера в сети на 
    рекомендованную изготовителем контроллеров;
*   Отключен keepAlive на всех каналах во избежание перерасхода траффика;
*   Добавлена команда `UARTVIEW:1(0)` для включения(отключения) трассировки 
    принятых пакетов от устройств modbus;
*   Добавлены команды для загрузки файлов на устройство для возможности 
    патча ядра;
*   Исправлен вывод ответов от запросов АТ-команд удаленно через вызов 
    `###AT[cmd]` где [cmd] - АТ-команда для модуля Telit EU866;
*   Добавлена возможность управления логированием (по умолчанию отключено) 
    через команду терминала `LOGSLVL:[val]`, где val - значения минимального 
    уровня регистрации событий:
        - 0 - DEBUG;
        - 1 - INFO;
        - 2 - WARNING;
        - 3 - ERROR;
        - 4 - FATAL;
        - 5 - отключает запись в лог событий. 
*   Добавлена индикация качества работы сквозного порта (если два и больше 
    отказов при ответе - на "8" сигнал мэк104 устанавливается 0, если опрос 
    успешен - единица) __Внимание:__ `При старте до первого опроса установлено 
    значение 0`;
*   Добавлен вывод IMEI при чтении конфигурации через ZtpConfig.

----------------------------------------------------------------------
Дата:   2021/06/29
Версия: 1.7.6

*   Исправлено подключение к сокету, когда уже подключен клиент;
*   Исправление воздействия призрачных клиентов (второй клиент подключается 
    когда уже идет работа с первым);
*   Изменен принцип работы таска пингования по IP;
*   Добавлена техническая команда перезапуска UART, путем ввода команды 
    `UARTR`; 
*   Изменена реакция на ошибку при создании серверного сокета 
    (при ошибке - перезагрузка устройства);
*   Исправлена первичный опрос модулей по модбас перед запуском таска 
    работы с мэк104;
*   Оптимизирована обработка команд настроек на порту 10251 - парсинг 
    и обработка выполняются в отдельном таске;
*   Изменена концепция отправки пакетов по мэк104;
*   Добавлен механизм перезагрузки UART если за период опроса модбас не 
    удалось успешно опросить ни одной группы тегов.

----------------------------------------------------------------------
Дата:   2021/05/12
Версия: 1.7.5

*   Изменен принцип передачи пакета с RS485 -> TCP;
*   Изменено определение нулевого адреса в пакетах счетчика для 
    сквозного канала;
*   Доработан механизм подготовки к перезапуску ULC02.

----------------------------------------------------------------------
Дата:   2021/04/21
Версия: 1.7.4

*   Доработан механизм обработки команды перезагрузки устройства;
*   Исправлено поведение обработки команды перезагрузки устройства 
    в рабочих потоках приложения.

----------------------------------------------------------------------
Дата:   2021/02/11
Версия: 1.7.3

*   Изменен алгоритм инициализации устройства (сперва подключаются 
    потоки собственных входов и выходов, затем поток модбаса и первый 
    опрос, затем уже поток мэк104).

----------------------------------------------------------------------
Дата:   2021/02/05
Версия: 1.7.2

*   Переработан алгоритм передачи команды управления с мэк104 в модбас;
*   Добавлен контроль результата от команды управления с передачей 
    корректного результата в мэк104;
*   Исправлен рассчет количества принятых пакетов за сессию в протоколе 
    мэк104.

----------------------------------------------------------------------
Дата:   2021/01/04
Версия: 1.7.1

*   Изменена обработка команд по каналу отладки;
*   Улучшение работы с сокетами TCP;
*   Исправлена обработка отладочной информации при выставлении флага 
    DEBUG.

----------------------------------------------------------------------
Дата:   2020/12/16
Версия: 1.7.0

*   Перенесена активация сокета обновления прошивке с начала работы на 
    обработку команды `UPDATE`;
*   Обработки тяжелых событий из прерываний перенесены в отдельный поток 
    с флагами;
*   Добавлена настройка функции пингования (`IP-адрес` и `период пинга`);
*   Добавлен функционал пинга других IP, для проверки собственной 
    работоспособности с сетью;
*   Убрана возможность перезагрузки устройства по коннекту к порту `10555`;
*   Отключена функция контроля длительности работы с клиентом по TCP;
*   Добавлена команда проверки IP адреса на отклик для пингования 
    (`PINGTEST:<IP>`);
*   Убрана команда установки контроля IP адреса клиента мэк104.

----------------------------------------------------------------------
Дата:   2020/11/25
Версия: 1.6.6

*   Временно добавлен сокет для перезагрузки `10555`;
*   Исправлен баг перезагрузки при отсутствии файлов логов в момент 
    старта устройства.

----------------------------------------------------------------------
Дата:   2020/11/23
Версия: 1.6.5

*   Изменен порядок запуска каналов при инициализации;
*   Объединены потоки работы с каналами данных 
    (канал отладки и сквозной канал);
*   Добавлена проверка доступа сокета при закрытии соединения на 
    канале мэк104;
*   Исправлено блокировка подключения сокетов (`5 быстрых отключений 
    и перезагрузка`);
*   Исправлено изменение параметров `k` и `w` для мэк104;
*   Добавлена команда вывода данных о клиенте мэк104 (`IPWHO?`);
*   Изменен принцип работы с сокетом мэк104 по таймерам `t1` и `t3`.

----------------------------------------------------------------------
Дата:   2020/09/17
Версия: 1.6.3

*   Разделена проверка файлов конфигурации (основной и дополнительный) 
    на корректность при инициализации.

----------------------------------------------------------------------
Дата:   2020/09/16
Версия: 1.6.2

*   Исправлено несоответствие индексаций `ТИ` и `ТУ` по мэк104 
    для тегов модбас;
*   Изменен алгоритм работы потока мэк104 (поток сервера и 
    поток клиента объединены).

----------------------------------------------------------------------
Дата:   2020/09/11
Версия: 1.6.1

*   Добавлено отключение дисконнекта при длительном бездействии со 
    стороны клиента(команды `ADVDBG?` и `ADVDBG:0(1)`).

----------------------------------------------------------------------
Дата:   2020/08/14
Версия: 1.6.0

*   Добавлен технический тег на качество опроса модулей по модбас;
*   Добавлено хранение описания тегов модбас для ztpConfig;
*   Добавлено задание зоны нечувствительности для аналоговых тегов модбас;
*   Добавлена функция привязки клиента мэк104 к определенному IP 
    (тестовый режим);
*   Исправлено значение индекса мэк104 для модбас - 
    расширена переменная до 2 байт.

----------------------------------------------------------------------
Дата:   2020/08/06
Версия: 1.5.1

*   Исправление незначительных багов.

----------------------------------------------------------------------
Дата:   2020/07/20
Версия: 1.5.0

*   Добавлена возможность обрабатывать команды до регистрации в сети;
*   Добавлена возможность устанавливать режим работы переключения 
    технологий 2G/3G;
*   Добавлена возможность устанавливать технологию связи GSM;
*   Добавлен перезапуск сокетов TCP при длительном отсутствии связи GSM;
*   Исправлено задание и использование номера устройства для мэк104;
*   Исправлена неисправность и отлючение связи при переключении технологии 
    сети 2G->3G и 3G->2G.

----------------------------------------------------------------------
Дата:   2020/05/25

*   Добавлена группировка тегов модбас для уменьшения времени опроса 
    внешних устройств;
*   Увеличено количество тегов модбас до 100.

----------------------------------------------------------------------
Дата:   2020/05/15
Версия: 1.3.0

*   Добавлена плановая перезагрузка устройства по времени;
*   Добавлена команда настройки плановой перезагрузки;
*   Добавлена команда чтения плановой перезагрузки.

----------------------------------------------------------------------
Дата:   2020/05/12
Версия: 1.2.0

*   Исправлен перезапуск при частой записи конфигурации на устройство;
*   Оптимизировано количество сохранений настроек при изменении 
    конфигурации устройства.

----------------------------------------------------------------------
Дата:   2020/05/05
Версия: 1.1.0

*   Добавлен флаг активации режима обновления прошивки, для завершения 
    рабочих потоков;
*   Добавлена возможность управления дискретными сигналами внешних 
    устройств модбас через мэк104;
*   Добавлены функции передачи сегментов данных без метки времени в мэк104;
*   Изменен алгоритм отключения рабочих подключений и реализация блокировок 
    рабочих соединений;
*   Изменена система нумерации тегов модбас в протоколе мэк104.

----------------------------------------------------------------------
Дата:   2020/05/03
Версия: 1.0.0

*   РЕЛИЗНАЯ ВЕРСИЯ С БАЗОВЫМ ФУНКЦИОНАЛОМ.